<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>University RAG Chat</title>

	<style>
		* {
			box-sizing: border-box;
		}

		:root {
			--bg-primary: #000000;
			--bg-secondary: #1c1c1e;
			--bg-tertiary: #2c2c2e;
			--bg-user: #0a84ff;
			--bg-assistant: #1c1c1e;
			--text-primary: #ffffff;
			--text-secondary: #8e8e93;
			--accent: #0a84ff;
			--border: #38383a;
			--link: #0a84ff;
			--link-hover: #409cff;
		}

		html, body {
			margin: 0;
			padding: 0;
			width: 400px;
			height: 550px;
			overflow: hidden;
			font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', Roboto, sans-serif;
			background: var(--bg-primary);
			color: var(--text-primary);
			-webkit-font-smoothing: antialiased;
		}

		.container {
			display: flex;
			flex-direction: column;
			height: 100%;
			padding: 16px;
			gap: 12px;
		}

		header {
			flex-shrink: 0;
			padding: 14px 18px;
			background: var(--bg-secondary);
			border-radius: 16px;
			border: 1px solid var(--border);
			backdrop-filter: blur(20px);
		}

		h1 {
			margin: 0;
			font-size: 17px;
			font-weight: 600;
			letter-spacing: -0.4px;
			display: flex;
			align-items: center;
			gap: 10px;
		}

		#health {
			font-size: 13px;
			color: var(--text-secondary);
			font-weight: 500;
		}

		#messages {
			flex: 1;
			overflow-y: auto;
			overflow-x: hidden;
			padding: 12px;
			background: var(--bg-primary);
			border-radius: 16px;
			display: flex;
			flex-direction: column;
			gap: 16px;
		}

		#messages::-webkit-scrollbar {
			width: 4px;
		}

		#messages::-webkit-scrollbar-track {
			background: transparent;
		}

		#messages::-webkit-scrollbar-thumb {
			background: var(--border);
			border-radius: 2px;
		}

		.msg {
			display: flex;
			flex-direction: column;
			gap: 6px;
			animation: slideUp 0.4s cubic-bezier(0.16, 1, 0.3, 1);
		}

		@keyframes slideUp {
			from {
				opacity: 0;
				transform: translateY(12px);
			}
			to {
				opacity: 1;
				transform: translateY(0);
			}
		}

		.msg.user {
			align-items: flex-end;
		}

		.bubble {
			max-width: 85%;
			padding: 12px 16px;
			border-radius: 20px;
			font-size: 15px;
			line-height: 1.4;
			word-wrap: break-word;
			letter-spacing: -0.2px;
		}

		.bubble.user {
			background: var(--bg-user);
			color: #ffffff;
			border-bottom-right-radius: 6px;
		}

		.bubble.bot {
			background: var(--bg-assistant);
			border-bottom-left-radius: 6px;
			border: 1px solid var(--border);
		}

		.bubble.entrance {
			animation: slideUp 0.4s cubic-bezier(0.16, 1, 0.3, 1);
		}

		.answer {
			margin-bottom: 0;
		}

		.sources {
			margin-top: 14px;
			padding-top: 14px;
			border-top: 1px solid var(--border);
			font-size: 13px;
			color: var(--text-secondary);
		}

		.sources strong {
			display: block;
			margin-bottom: 8px;
			color: var(--text-primary);
			font-weight: 600;
			font-size: 12px;
			text-transform: uppercase;
			letter-spacing: 0.5px;
		}

		.source-link {
			display: inline-block;
			color: var(--link);
			text-decoration: none;
			margin: 4px 6px 4px 0;
			padding: 4px 10px;
			border-radius: 8px;
			background: rgba(10, 132, 255, 0.12);
			transition: all 0.2s cubic-bezier(0.16, 1, 0.3, 1);
			font-size: 13px;
			font-weight: 500;
			max-width: 200px;
			overflow: hidden;
			text-overflow: ellipsis;
			white-space: nowrap;
		}

		.source-link:hover {
			color: var(--link-hover);
			background: rgba(10, 132, 255, 0.2);
			transform: scale(1.02);
		}

		.source-link:active {
			transform: scale(0.98);
		}

		/* Apple-style gradient loader */
		.loader-bubble {
			background: var(--bg-assistant);
			border: 1px solid var(--border);
			border-bottom-left-radius: 6px;
			padding: 20px 24px;
			position: relative;
			overflow: hidden;
		}

		.loader-gradient {
			position: absolute;
			top: 0;
			left: -100%;
			width: 100%;
			height: 100%;
			background: linear-gradient(
				90deg,
				transparent,
				rgba(10, 132, 255, 0.15),
				rgba(191, 90, 242, 0.15),
				rgba(255, 55, 95, 0.15),
				transparent
			);
			animation: shimmer 2s infinite;
		}

		@keyframes shimmer {
			0% {
				left: -100%;
			}
			100% {
				left: 100%;
			}
		}

		.loader-dots {
			display: flex;
			gap: 6px;
			align-items: center;
			position: relative;
			z-index: 1;
		}

		.dot {
			width: 8px;
			height: 8px;
			border-radius: 50%;
			background: linear-gradient(135deg, #0a84ff, #bf5af2);
			animation: pulse 1.4s infinite ease-in-out;
		}

		.dot:nth-child(1) {
			animation-delay: -0.32s;
		}

		.dot:nth-child(2) {
			animation-delay: -0.16s;
			background: linear-gradient(135deg, #bf5af2, #ff375f);
		}

		.dot:nth-child(3) {
			background: linear-gradient(135deg, #ff375f, #ff9f0a);
		}

		@keyframes pulse {
			0%, 80%, 100% {
				transform: scale(0.7);
				opacity: 0.5;
			}
			40% {
				transform: scale(1);
				opacity: 1;
			}
		}

		#controls {
			flex-shrink: 0;
			display: flex;
			gap: 10px;
			padding: 12px;
			background: var(--bg-secondary);
			border-radius: 16px;
			border: 1px solid var(--border);
		}

		#question {
			flex: 1;
			padding: 12px 14px;
			background: var(--bg-tertiary);
			border: 1px solid var(--border);
			border-radius: 12px;
			color: var(--text-primary);
			font-size: 15px;
			outline: none;
			transition: all 0.2s cubic-bezier(0.16, 1, 0.3, 1);
			letter-spacing: -0.2px;
		}

		#question:focus {
			border-color: var(--accent);
			background: var(--bg-secondary);
		}

		#question::placeholder {
			color: var(--text-secondary);
		}

		#send {
			padding: 12px 24px;
			background: var(--accent);
			color: white;
			border: none;
			border-radius: 12px;
			font-size: 15px;
			font-weight: 600;
			cursor: pointer;
			transition: all 0.2s cubic-bezier(0.16, 1, 0.3, 1);
			letter-spacing: -0.2px;
		}

		#send:hover {
			transform: scale(1.02);
			box-shadow: 0 4px 12px rgba(10, 132, 255, 0.4);
		}

		#send:active {
			transform: scale(0.98);
		}

		#reindex {
			display: none;
		}
	</style>
</head>

<body>
	<div class="container">
		<header>
			<h1>
				University RAG
				<span id="health">â€¦</span>
			</h1>
		</header>

		<div id="messages"></div>

		<div id="controls">
			<input id="question" placeholder="Ask a question..." />
			<button id="send">Send</button>
			<button id="reindex" style="display:none;">Reindex</button>
		</div>
	</div>

	<script src="popup.js"></script>
</body>
</html>